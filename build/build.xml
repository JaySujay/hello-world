<project name="bulkloader" xmlns:artifact="antlib:org.apache.maven.artifact.ant"  basedir=".">

	<property file="build.properties" /> 

	<!-- needed by build-common-tasks.xml -->
	<property file="../include/ant/build-common.properties"/>
	<property file="../include/ant/build-common-${os.name}.properties"/>

	<!-- needed for compc -->
	<import file="../include/ant/build-common-tasks.xml" />

	<artifact:pom file="pom.xml" id="pom"/>

	<artifact:install-provider artifactId="wagon-webdav-jackrabbit" version="2.5"/>
	
	<target name="clean" description="Cleans the output directory">
		<delete dir="${output.dir}"/>
		<mkdir dir="${output.dir}"/>
	</target>
	
	<target name="compile" description="Compile the bulkloader library">
		<artifact:dependencies pathId="compile.path">
			<artifact:pom refid="pom"/>
		</artifact:dependencies>
		<property name="compile.path.property" refid="compile.path"/>
		<compc
			name="${main}"
			src.dir="${src.dir}"
			output.dir="${output.dir}"
			additional="-compiler.optimize -library-path+=${compile.path.property}" />
	</target>
	
	<target name="publish" description="Publish the compiled artifact to the ivy repository">
		<artifact:deploy file="${output.dir}/${main}.swc">
			<artifact:pom refid="pom"/>
		</artifact:deploy>
	</target>
</project>
